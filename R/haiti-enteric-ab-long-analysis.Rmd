---
title: "Haiti enteric antibody analysis of longitudinal change"
output: 
  html_document:
    highlight: haddock
    theme: default
    code_folding: show
    df_print: paged
    toc: yes
    toc_depth: '3'
    toc_float:
      collapsed: yes
      smooth_scroll: yes
  html_notebook:
    theme: default
    highlight: haddock
    toc: true
    toc_depth: 3
    toc_float:
      collapsed: true
      smooth_scroll: true
---

# Summary

This script summarizes the change in antibody levels within individual children.  It also evaluates how well increases in antibody levels classify incident seroconversion events, and estimates the sensitivity, specificity, PPV, and NPV for a 4-fold increase and a for a fold increase that maximizes the Youden Index (the difference between the true positive rate and the false positive rate). 


# Script preamble
```{r preamble}
#-----------------------------
# preamble
#-----------------------------
library(here)
here()

# load packages
library(tidyverse)
library(kableExtra)
library(ROCR)


# set up for parallel computing
# configure for a laptop (use only 3 cores)
library(foreach)
library(doParallel)
registerDoParallel(cores=3)

# bright color blind palette:  https://personal.sron.nl/~pault/ 
cblack <- "#000004FF"
cblue <- "#3366AA"
cteal <- "#11AA99"
cgreen <- "#66AA55"
cchartr <- "#CCCC55"
cmagent <- "#992288"
cred <- "#EE3333"
corange <- "#EEA722"
cyellow <- "#FFEE33"
cgrey <- "#777777"

```


```{r load data}
#-----------------------------
# load the formatted data
# created with 
# asembo-enteric-ab-data-format.Rmd
#-----------------------------
dl <- readRDS(here("data","haiti_analysis2.rds"))

# list the enteric antigens and formatted labels for them
mbavars <- c("vsp3","vsp5","cp17","cp23","leca","etec","salb","sald","norogi","norogii")

mbalabs <- c("Giardia VSP-3","Giardia VSP-5","Cryptosporidium Cp17","Cryptosporidium Cp23","E. histolytica LecA","ETEC toxin beta subunit","Salmonella LPS B","Salmonella LPS D","Norovirus GI", "Norovirus GII")
```

# Identify incident changes
Among children, identify those that changed status between enrollment and follow-up. Those who changed from negative to positive are seroconverters (`seroi` below), and those who changed from positive to negative are seroreverters (`seror` below).


```{r long incidence}

#-----------------------------
# identify seropositive measures
# hierarchy of information for 
# cutoffs:
# 1. ROC
# 2. mixture model based
# 3. estimated among presumed unexposed
#
# store the cutoff value used
# for figures
#-----------------------------
dl <- dl %>%
  mutate(seropos=ifelse(!is.na(posroc),posroc,posmix),
         serocut=ifelse(!is.na(posroc),roccut,mixcut),
         serocut_desc=ifelse(!is.na(posroc),"ROC","Mixture Model")) %>%
  mutate(seropos=ifelse(!is.na(seropos),seropos,posunex),
         serocut_desc=ifelse(!is.na(serocut),serocut_desc,"Unexp dist"),
         serocut=ifelse(!is.na(serocut),serocut,unexpcut)) 


#-----------------------------
# identify incident 
# seroconversions and reversions
#-----------------------------

# group the data by child and
# use lags to identify
# time in years between measurements,
# sero-conversions + sero-reversions 
# between measurements
# set the first measurement to 
# missing for the incidence indicators
# (using the is.na(age_diff) to identify them)
dl2 <- dl %>%
  group_by(antigen,id) %>% 
  arrange(antigen,id,sdate,sampleid) %>%
  mutate(age_min  = min(age),
         age_diff = age - lag(age),
         
         logmfi_lag  = lag(logmfi),
         logmfi_lead = lead(logmfi),
         logmfi_dlag  = logmfi - logmfi_lag,
         logmfi_dlead = logmfi_lead - logmfi,
         
         # incident seroconversions and reversions
         # including cumulative numbers
         seropos_lag  = lag(seropos),
         seroi = ifelse(seropos==1 & seropos_lag==0,1,0),
         seroi = ifelse(is.na(age_diff),NA,seroi),
         seroin = cumsum(ifelse(is.na(seroi),0,seroi)),
         seroin = ifelse(seroi==1,seroin,0),
         seror = ifelse(seropos==0 & seropos_lag==1,1,0),
         seror = ifelse(is.na(age_diff),NA,seror),
         serorn = cumsum(ifelse(is.na(seror),0,seror)),
         serorn = ifelse(seror==1,serorn,0)
         ) %>%
  select(
         id,sampleid,sdate,
         starts_with("age"),
         pathogen,antigen,antigenf,
         mfi,logmfi,logmfi_dlag,logmfi_dlead,
         roccut,mixcut,serocut,
         posroc,posmix,seropos,seroi,seroin,seror,serorn,
         -logmfi_lag,-logmfi_lead,-seropos_lag)


```

# Longitudinal child trajectories

```{r figure of individual MFI trajectories}

dl2plot <- dl2 %>% group_by(id)
dl2plot$sid <- group_indices(dl2plot)
dl2plot$sid <- factor(dl2plot$sid)

# color by MFI increases/decreases or seroconversion/reversion statsus
dl2plot <- dl2plot %>%
  mutate(
    logmfi_chng  = ifelse(logmfi_dlag>0,"Increasing","Decreasing"),
    logmfi_chng = ifelse(is.na(logmfi_chng) & logmfi_dlead>0,"Increasing",logmfi_chng),
    logmfi_chng = ifelse(is.na(logmfi_chng) & logmfi_dlead<0,"Decreasing",logmfi_chng),
    logmfi_chng = factor(logmfi_chng,levels=c("Increasing","Decreasing")),
    
    sero_chng = ifelse(lead(seroi)==1,"Seroconversion","No change"),
    sero_chng = ifelse(lead(seror)==1,"Seroreversion",sero_chng),
    sero_chng = ifelse(is.na(sero_chng),lead(sero_chng),sero_chng),
    sero_chng = factor(sero_chng,levels=c("Seroconversion","Seroreversion","No change"))
    
  )


# custom color blind color palette is in the preamble chunck
# pcols <- c(cred,corange,cgreen,cteal,cblue,cmagent)
pcols <- c(corange,cred,cmagent,cblue,cteal,cgreen)

# custom log labels
log10labs <- c( 
  expression(10^0),
  expression(10^1),
  expression(10^2),
  expression(10^3),
  expression(10^4)
)

# plot all trajectories, colored (doesn't look that great)
# p <- ggplot(dl2plot, aes(x=age, y=logmfi, group=factor(id),color=sero_chng) ) +
#     facet_wrap(~antigenf,nrow=6,ncol=2)+
#     geom_line(alpha=0.1) +
#     guides(colour=FALSE) +
#     guides(alpha=FALSE) +
#     # geom_line(data=filter(dl2plot,sid==iid),aes(x=age,y=logmfi),size=1.2) +
#     scale_color_manual(values=c(corange,cteal,cgrey))+
#     xlab("Child Age (Years)") +
#     ylab("Luminex Response (MFI-bg)") +
#     coord_cartesian(ylim=c(0, 4.5))+
#     scale_y_continuous(breaks=0:4,labels=log10labs) +
#     scale_x_continuous(limits=c(0,10),breaks=seq(0,10,by=2)) +
#     theme_minimal() +
#     theme(
#       # strip.text = element_text(size=16),
#       # axis.text.x=element_text(size=12),
#       # axis.text.y=element_text(size=12),
#       # axis.title.x=element_text(size=14),
#       # axis.title.y=element_text(size=14),
#       legend.position="none"
#     )
# 
# p

# highlight a handfull of example individual trajectories
for(iid in c(20,24,30,34,35,38,43,47,72,76,77,119,135)) {
  p <- ggplot(dl2plot, aes(x=age, y=logmfi, group=factor(id)) ) +
    facet_wrap(~antigenf,nrow=6,ncol=2)+
    geom_line(alpha=0.1,color=cgrey) +
    guides(colour=FALSE) +
    guides(alpha=FALSE) +
    geom_hline(aes(yintercept=serocut),linetype="dashed") +
    geom_line(data=filter(dl2plot,sid==iid),aes(x=age,y=logmfi,color=sero_chng)) +
    scale_color_manual(values=c(corange,cteal,cgrey))+
    xlab("Child Age (Years)") +
    ylab("Luminex Response (MFI-bg)") +
    coord_cartesian(ylim=c(0, 4.5))+
    scale_y_continuous(breaks=0:4,labels=log10labs) +
    scale_x_continuous(limits=c(0,10),breaks=seq(0,10,by=2)) +
    theme_minimal() +
    theme(
      legend.position="none"
    )
  
  p

  ggsave(filename=here("figs",paste("haiti-spaghetti-",iid,".pdf",sep="")),plot = p,device='pdf',width=5,height=14)

}

```

# Analysis of change in MFI


```{r create serostatus indicators}
#----------------------------------
# Create a factor that summarizes 
# seroconversion status, with 4 categories:
# seroreversion, no change, 1st seroconversion, 
# 2nd or 3rd seroconversion
#----------------------------------
dl3 <- dl2 %>%
  mutate(seroinf=cut(seroin,breaks=c(-1,0,1,5),
                     labels=c("No change", 
                              "1st\nseroconversion", 
                              "2nd or 3rd\nseroconversion")),
         serostat = seroinf
  )

dl3$serostat = factor(dl3$serostat,levels=c("Seroreversion",levels(dl3$seroinf))) 
dl3$serostat[dl3$seror==1] <- "Seroreversion"
```

## Fig 3 Distribution of changes in MFI by seroconversion status
```{r change in MFI by episode, fig.width=7,fig.height=7}

dl3plot <- dl3
                          
# calculate Ns in each seroconversion category to print in the figure
epiNs <- dl3plot %>%
  group_by(pathogen,antigenf,serostat) %>%
  summarize(n=n()) %>%
  filter(!is.na(serostat)) %>%
  mutate(nlab=paste("(n=",n,")",sep=""))


# custom color blind color palette is in the preamble chunck
# pcols <- c(cred,corange,cgreen,cteal,cblue,cmagent)
pcols <- c(corange,cred,cmagent,cblue,cteal,cgreen)

set.seed(123)
diffmfi_byepisode <- ggplot(data=filter(dl3plot,!is.na(serostat)),aes(x=serostat,y=logmfi_dlag,fill=pathogen,color=pathogen)) +
  facet_wrap(~antigenf,nrow=6,ncol=4)+ 
  geom_jitter(position = position_jitter(width = 0.2), alpha = 0.2,pch=19) +
  geom_boxplot(notch=FALSE,outlier.color=NA,width=0.5,alpha=0.5,fill=NA,color="grey20")+
  geom_hline(aes(yintercept = log10(2)),lty="dashed") +
  geom_hline(aes(yintercept = 0)) +
  # add Ns
  geom_text(data=epiNs,aes(x=serostat,y=-3.25,label=nlab),col="gray40",size=2) +
  scale_y_continuous(expand=c(0,0),limits=c(-3.5,4.5),breaks=-3:4) +
  scale_fill_manual(values=pcols)+
  scale_color_manual(values=pcols)+
  labs(title="",x="Seroconversion status",y="Change in log10 Luminex Response (MFI-bg) between measurements") +
  theme_minimal(base_size=12)+
  theme(
    panel.grid.minor.x = element_blank(),
    axis.text.x=element_text(angle=45,hjust=1),
    legend.position="none"
  )

diffmfi_byepisode

# save a PDF version
ggsave(here("figs","haiti-ab-mfidiff-byepisode.pdf"),plot=diffmfi_byepisode,device="pdf",width=9,height=8)


```

## Distribution of changes in MFI by age category
```{r change in MFI by agecat, fig.width=7,fig.height=7}

# Difference in MFI values - boxplot
dl3plot2 <- dl2 %>%
  mutate(agecat=cut(age,breaks=c(0,0.99,1.99,2.99,3.99,4.99,12),labels=c("0","1","2","3","4","5+")))

# calculate Ns in each age category to print in the figure
ageNs <- dl3plot2 %>%
  group_by(pathogen,antigenf,agecat) %>%
  summarize(n=n()) %>%
  filter(!is.na(agecat)) %>%
  mutate(nlab=paste("(n=",n,")",sep=""))

# custom color blind color palette is in the preamble chunck
# pcols <- c(cred,corange,cgreen,cteal,cblue,cmagent)
pcols <- c(corange,cred,cmagent,cblue,cteal,cgreen)

diffmfi_byage <- ggplot(data=dl3plot2,aes(x=agecat,y=logmfi_dlead,fill=pathogen,color=pathogen)) +
  facet_wrap(~antigenf,nrow=6,ncol=4)+ # ,scales='free_y'
  geom_jitter(position = position_jitter(width = 0.2), alpha = 0.2,pch=19) +
  geom_boxplot(notch=FALSE,outlier.color=NA,width=0.5,alpha=0.5,fill=NA,color="grey20")+
  geom_hline(aes(yintercept = 0)) +
  geom_text(data=ageNs,aes(x=agecat,y=-3.75,label=nlab),col="gray40",size=2) +

  scale_y_continuous(expand=c(0,0),limits=c(-4,4.5),breaks=-3:4) +
  scale_fill_manual(values=pcols)+
  scale_color_manual(values=pcols)+
  labs(title="",x="Age at beginning of period (years completed)",y="Change in log10 Luminex Response (MFI-bg) between measurements") +
  theme_minimal(base_size=12)+
  theme(
    panel.grid.minor.x = element_blank(),
    legend.position="none"
  )

diffmfi_byage

# save a PDF version
ggsave(here("figs","haiti-ab-mfidiff-byage.pdf"),plot=diffmfi_byage,device="pdf",width=9,height=8)


```

# Evaluate classification based on increase in antibody levels

For each increase in antibody levels, estimate the true positive rate (sensitivity), false positive rate (1-specificity), the area under the curve (AUC) of the receiver operator characteristic curve, and the optimal increase based on the Youden index, which maximizes the difference between the true positive rate and the false positive rate. 



```{r rocr estimates }
rocr_ests <- foreach(ab=levels(dl3$antigenf)) %dopar% {
  datai <- dl3 %>% filter(antigenf==ab)
  
  # Summary statistics for a 4-fold increase in Ab levels
  incr4_tp <- sum( (datai$logmfi_dlag >log10(4) ) & datai$seroi,na.rm=TRUE )
  incr4_fp <- sum( (datai$logmfi_dlag >log10(4) ) & (!datai$seroi),na.rm=TRUE )
  incr4_tn <- sum( (datai$logmfi_dlag<=log10(4) ) & (!datai$seroi),na.rm=TRUE )
  incr4_fn <- sum( (datai$logmfi_dlag<=log10(4) ) & (datai$seroi),na.rm=TRUE )
  incr4sens <- incr4_tp / sum(datai$seroi,na.rm=TRUE)
  incr4spec <- incr4_tn / sum(!datai$seroi,na.rm=TRUE)
  incr4ppv <-  incr4_tp / (incr4_tp + incr4_fp)
  incr4npv <-  incr4_tn / (incr4_tn + incr4_fn)
  # Get full ROC curve
  predi <- prediction(predictions=datai$logmfi_dlag,labels=datai$seroi)
  # get PPV and NPV
  pnvi  <- performance(predi,measure="ppv",x.measure="npv")
  ppvi  <- pnvi@y.values[[1]]
  npvi  <- pnvi@x.values[[1]]
  # fit the ROC curve and its AUC
  roci  <- performance(predi,measure="tpr",x.measure="fpr")
  auci  <- performance(predi,measure="auc")@y.values[[1]]
  # increase in antibody levels
  cuti  <- roci@alpha.values[[1]]
  # true positive rate for every increase in antibody levels
  tpri  <- roci@y.values[[1]]
  # false positive rate for every increase in antibody levels
  fpri  <- roci@x.values[[1]]
  # Youden index
  youi  <- tpri - fpri
  # Summary statistics for optimal cutoff based on Youden index
  opti  <- cuti[youi==max(youi)]
  optsens <- tpri[youi==max(youi)]
  optspec <- 1-fpri[youi==max(youi)]
  optppv  <- ppvi[youi==max(youi)]
  optnpv  <- npvi[youi==max(youi)]
  # return a list
  list(antigenf=ab,auc=auci,incr4sens=incr4sens,incr4spec=incr4spec,incr4ppv=incr4ppv,incr4npv=incr4npv,optcut=opti,sens=optsens,spec=optspec,ppv=optppv,npv=optnpv,abincr=cuti,tpr=tpri,fpr=fpri,youden=youi)
  
}

# collate the summary statistics into a single data frame
rocr_sum <- foreach(i=1:10,.combine=rbind) %do% {
  data.frame(rocr_ests[[i]][1:11])
}

# collate the ROC curve data and related ests into a single data frame
d_rocr <- foreach(i=1:10,.combine=rbind) %do% {
  di <- data.frame(rocr_ests[[i]][12:15])
  di <- di %>% mutate(antigenf=factor(rocr_ests[[i]]$antigenf,levels(dl3$antigenf)))
}

```

## Table 2 - supplement 1
```{r rocr table }
rocr_sum2 <- rocr_sum %>%
  mutate(fold_incr = 10^optcut) %>%
  select(antigenf,auc,starts_with("incr4"),fold_incr,sens,spec,ppv,npv)

knitr::kable(rocr_sum2,digits=2,
             col.names = c("Antigen","AUC", "Sens.","Spec.","PPV","NPV","Fold incr.","Sens.","Spec.","PPV","NPV")) %>%
  kable_styling(bootstrap_options = c("striped"),full_width = TRUE) %>%
  add_header_above(c(" " = 2, "4 Fold Increase in MFI" = 4, "Fold-Increase in MFI that Maximized Youden Index *" = 5)) %>%
  footnote(general = "AUC: Area under the receiver-operator characteristic curve; Sens.: sensitivity; Spec.: specificity; PPV: positive predictive value; NPV: negative predictive value.",
           symbol = c("Youden Index equals the difference between the true positive rate and the false positive rate (an optimal tradeoff between sensitivity and specificity). ")
           )

```

## ROC curves
```{r roc fig }
proc <- ggplot(data=d_rocr,aes(x=fpr,y=tpr)) +
  geom_line() +
  geom_text(data=rocr_sum,aes(x=0.7,y=0.2,label=paste("AUC =",sprintf("%1.2f",auc))) )+
  facet_wrap(~antigenf,ncol=4,nrow=3)+
  scale_y_continuous(breaks=seq(0,1,by=0.2))+
  scale_x_continuous(breaks=seq(0,1,by=0.2))+
  labs(x="False Positive Rate (1-Specificity)",y="True Positive Rate (Sensitivity)")+
  theme_minimal()

proc
```


# Classification using only primary seroconversions

As a sensitivity analysis, restrict the analysis to observations up until a child's primary seroconversion event.
The rationale is that there is significant antibody boosting and waning that can occur above the seropositivity threshold.  This would be expected to reduce the specificity of the fold-change in antibody levels (and also reduce the positive predictive value).
```{r rocr estimates primary seroconversion }

# Identify children with a primary seroconversion 
# Identify the sample ID (round) number when  it occurred
dl4 <- dl3 %>%
  group_by(antigen,id) %>%
  mutate(psci=ifelse(serostat=="1st\nseroconversion",1,0),
         sid_psci = ifelse(psci==1,as.numeric(sampleid),0)) %>%
  summarize(psci=max(psci,na.rm=T),sid_psci=max(sid_psci,na.rm=T)) %>%
  right_join(.,dl3,by=c("antigen","id"))

# For children/antigens with a primary seroconversion, 
#   filter to observations up until that point
# For children without a primary serconversion,  
#   filter to observations that are seronegative
dl4 <- dl4 %>%
  filter((psci==1 & as.numeric(sampleid)<=sid_psci) | (psci==0 & seropos==0) ) %>%
  filter(seropos==0 | (seropos==1 & serostat=="1st\nseroconversion" ) )

rocr_ests_psc <- foreach(ab=levels(dl4$antigenf)) %dopar% {
  datai <- dl4 %>% filter(antigenf==ab)
  
  # Summary statistics for a 4-fold increase in Ab levels
  incr4_tp <- sum( (datai$logmfi_dlag >log10(4) ) & datai$seroi,na.rm=TRUE )
  incr4_fp <- sum( (datai$logmfi_dlag >log10(4) ) & (!datai$seroi),na.rm=TRUE )
  incr4_tn <- sum( (datai$logmfi_dlag<=log10(4) ) & (!datai$seroi),na.rm=TRUE )
  incr4_fn <- sum( (datai$logmfi_dlag<=log10(4) ) & (datai$seroi),na.rm=TRUE )
  incr4sens <- incr4_tp / sum(datai$seroi,na.rm=TRUE)
  incr4spec <- incr4_tn / sum(!datai$seroi,na.rm=TRUE)
  incr4ppv <-  incr4_tp / (incr4_tp + incr4_fp)
  incr4npv <-  incr4_tn / (incr4_tn + incr4_fn)
  # Get full ROC curve
  predi <- prediction(predictions=datai$logmfi_dlag,labels=datai$seroi)
  # get PPV and NPV
  pnvi  <- performance(predi,measure="ppv",x.measure="npv")
  ppvi  <- pnvi@y.values[[1]]
  npvi  <- pnvi@x.values[[1]]
  # fit the ROC curve and its AUC
  roci  <- performance(predi,measure="tpr",x.measure="fpr")
  auci  <- performance(predi,measure="auc")@y.values[[1]]
  # increase in antibody levels
  cuti  <- roci@alpha.values[[1]]
  # true positive rate for every increase in antibody levels
  tpri  <- roci@y.values[[1]]
  # false positive rate for every increase in antibody levels
  fpri  <- roci@x.values[[1]]
  # Youden index
  youi  <- tpri - fpri
  # Summary statistics for optimal cutoff based on Youden index
  opti  <- cuti[youi==max(youi)]
  optsens <- tpri[youi==max(youi)]
  optspec <- 1-fpri[youi==max(youi)]
  optppv  <- ppvi[youi==max(youi)]
  optnpv  <- npvi[youi==max(youi)]
  # return a list
  list(antigenf=ab,auc=auci,incr4sens=incr4sens,incr4spec=incr4spec,incr4ppv=incr4ppv,incr4npv=incr4npv,optcut=opti,sens=optsens,spec=optspec,ppv=optppv,npv=optnpv,abincr=cuti,tpr=tpri,fpr=fpri,youden=youi)
  
}

# collate the summary statistics into a single data frame
rocr_sum_psc <- foreach(i=1:10,.combine=rbind) %do% {
  data.frame(rocr_ests_psc[[i]][1:11])
}

# collate the ROC curve data and related ests into a single data frame
d_rocr_psc <- foreach(i=1:10,.combine=rbind) %do% {
  di <- data.frame(rocr_ests_psc[[i]][12:15])
  di <- di %>% mutate(antigenf=factor(rocr_ests_psc[[i]]$antigenf,levels(dl4$antigenf)))
}

```

## Table of alternate estimates based on primary seroconversions
```{r rocr table primary seroconversion}
rocr_sum_psc2 <- rocr_sum_psc %>%
  mutate(fold_incr = 10^optcut) %>%
  select(antigenf,auc,starts_with("incr4"),fold_incr,sens,spec,ppv,npv)

knitr::kable(rocr_sum_psc2,digits=2,
             col.names = c("Antigen","AUC", "Sens.","Spec.","PPV","NPV","Fold incr.","Sens.","Spec.","PPV","NPV")) %>%
  kable_styling(bootstrap_options = c("striped"),full_width = TRUE) %>%
  add_header_above(c(" " = 2, "4 Fold Increase in MFI" = 4, "Fold-Increase in MFI that Maximized Youden Index *" = 5)) %>%
  footnote(general = "AUC: Area under the receiver-operator characteristic curve; Sens.: sensitivity; Spec.: specificity; PPV: positive predictive value; NPV: negative predictive value.",
           symbol = c("Youden Index equals the difference between the true positive rate and the false positive rate (an optimal tradeoff between sensitivity and specificity). ")
           )

```

## ROC curves
```{r roc fig primary seroconverion }

# bind the ROC curve data together to plot both curves on the same figure
d_rocr <- d_rocr %>% mutate(population="All seroconversions")
d_rocr_psc <- d_rocr_psc %>% mutate(population="Primary seroconversions")
d_rocr_combo <- bind_rows(d_rocr,d_rocr_psc) %>%
  mutate(population=factor(population,levels=c("Primary seroconversions","All seroconversions")))

proc_combo <- ggplot(data=d_rocr_combo,aes(x=fpr,y=tpr,color=population)) +
  geom_line(alpha=0.8) +
  facet_wrap(~antigenf,ncol=4,nrow=3)+
  scale_y_continuous(breaks=seq(0,1,by=0.2))+
  scale_x_continuous(breaks=seq(0,1,by=0.2))+
  scale_color_manual(values=c(cblue,corange))+
  labs(x="False Positive Rate (1-Specificity)",y="True Positive Rate (Sensitivity)")+
  theme_minimal() +
  theme(legend.position = "top")

proc_combo
```

# Session Info
```{r session info}
sessionInfo()
```




